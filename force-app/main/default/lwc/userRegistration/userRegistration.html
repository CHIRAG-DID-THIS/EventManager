<template>
    <c-landingpageheader></c-landingpageheader>
    <div class="auth-container">
        
        <div class="form-container">

            <template if:true={isLoginView}>
                <div class="form-content">
                    <div class="slds-text-align_center">
                        <lightning-icon icon-name="standard:user" size="large"></lightning-icon>
                        <h2 class="form-title slds-text-heading_large slds-m-vertical_medium">Welcome Back!</h2>
                        <p class="form-subtitle slds-m-bottom_large">Please log in to your account.</p>
                    </div>

                    <lightning-input class="slds-m-bottom_medium" label="Username (Email)" type="email" value={username} name="username" onchange={handleInputChange} required></lightning-input>
                    <lightning-input class="slds-m-bottom_large" label="Password" type="password" value={password} name="password" onchange={handleInputChange} required></lightning-input>
                    
                    <lightning-button label="Login" variant="brand" onclick={handleLogin} disabled={isLoading} class="slds-button_stretch"></lightning-button>
                    
                    <div class="slds-m-top_large slds-text-align_center">
                        <a href="#" onclick={navigateToRegister} class="link-style">Don't have an account? Register</a>
                    </div>
                </div>
            </template>

            <template if:true={isRegisterView}>
                <div class="form-content">
                    <h2 class="form-title slds-text-heading_large slds-text-align_center slds-m-bottom_medium">Create Your Account</h2>
                    
                    <div class="slds-m-bottom_large">
                        <lightning-progress-indicator current-step={currentStep} type="path" has-error="false" variant="base">
                            <lightning-progress-step label="User Type" value="1"></lightning-progress-step>
                            <lightning-progress-step label="Your Details" value="2"></lightning-progress-step>
                            <lightning-progress-step label="Company Info" value="3"></lightning-progress-step>
                        </lightning-progress-indicator>
                    </div>


                    <template if:true={isStepOne}>
                        <h3 class="slds-text-heading_medium slds-m-bottom_medium slds-text-align_center">First, tell us who you are.</h3>
                        <div class="slds-box slds-box_border-dashed slds-p-around_medium radio-group-box">
                             <lightning-radio-group name="userType" label="I am a..." options={userTypeOptions} value={userType} onchange={handleInputChange} type="radio" required></lightning-radio-group>
                        </div>
                        <div class="slds-m-top_large slds-grid slds-grid_align-spread">
                            <lightning-button label="Back to Login" onclick={navigateToLogin}></lightning-button>
                            <lightning-button label="Next" variant="brand" onclick={handleNext} disabled={isNextDisabled}></lightning-button>
                        </div>
                    </template>

                    <template if:true={isStepTwo}>
                        <h3 class="slds-text-heading_medium slds-m-bottom_medium slds-text-align_center">Register as a {userType}</h3>
                        
                        <template if:true={isVendor}>
                            <lightning-input class="slds-m-bottom_small" type="text" label="Vendor Name" name="vendorName" value={vendorName} required onchange={handleInputChange}></lightning-input>
                            <lightning-input class="slds-m-bottom_small" type="tel" label="Contact No" name="contactNo" value={contactNo} required onchange={handleInputChange}></lightning-input>
                            <lightning-input class="slds-m-bottom_small" type="email" label="Email" name="regEmail" value={regEmail} required onchange={handleInputChange}></lightning-input>
                            <lightning-input class="slds-m-bottom_small" type="password" label="Password" name="regPassword" value={regPassword} required onchange={handleInputChange}></lightning-input>
                            <lightning-input class="slds-m-bottom_small" type="password" label="Confirm Password" name="confirmPassword" value={confirmPassword} required onchange={handleInputChange}></lightning-input>
                        </template>
                        
                        <template if:false={isVendor}>
                            <lightning-input class="slds-m-bottom_small" type="text" label="First Name" name="regFirstName" value={regFirstName} required onchange={handleInputChange}></lightning-input>
                            <lightning-input class="slds-m-bottom_small" type="text" label="Last Name" name="regLastName" value={regLastName} required onchange={handleInputChange}></lightning-input>
                            <lightning-input class="slds-m-bottom_small" type="email" label="Email Address" name="regEmail" value={regEmail} required onchange={handleInputChange}></lightning-input>
                            <lightning-input class="slds-m-bottom_small" type="tel" label="Contact No" name="contactNo" value={contactNo} onchange={handleInputChange}></lightning-input>
                            <lightning-input class="slds-m-bottom_small" type="password" label="Password" name="regPassword" value={regPassword} required onchange={handleInputChange}></lightning-input>
                            <lightning-input class="slds-m-bottom_small" type="password" label="Confirm Password" name="confirmPassword" value={confirmPassword} required onchange={handleInputChange}></lightning-input>
                        </template>
                        
                        <div class="slds-m-top_large slds-grid slds-grid_align-spread">
                            <lightning-button label="Back" onclick={handleBack}></lightning-button>
                            <lightning-button label="Register" variant="brand" onclick={handleRegister} disabled={isLoading}></lightning-button>
                        </div>
                    </template>

                    <template if:true={isStepThree}>
                        <h3 class="slds-text-heading_medium slds-m-bottom_small slds-text-align_center">Complete Your Company Profile</h3>
                        <p class="form-subtitle slds-m-bottom_large slds-text-align_center">Provide business details to get started.</p>

                        <lightning-input class="slds-m-bottom_small" label="Company Name" data-field="Company_Name__c" value={company.Company_Name__c} onchange={handleCompanyChange} required></lightning-input>
                        <lightning-input class="slds-m-bottom_small" label="Company Registration No" name="CompanyRegNo__c" value={company.CompanyRegNo__c} onchange={handleCompanyChange} required></lightning-input>
                        <lightning-dual-listbox class="slds-m-bottom_small" name="EventType__c" label="Event Types Handled" source-label="Available" selected-label="Chosen" options={eventTypeOptions} onchange={handleCompanyChange}></lightning-dual-listbox>
                        <lightning-input class="slds-m-bottom_small" label="Phone" name="Phone__c" type="tel" value={company.Phone__c} onchange={handleCompanyChange}></lightning-input>
                        <lightning-input class="slds-m-bottom_small" label="City" name="City__c" value={company.City__c} onchange={handleCompanyChange} required></lightning-input>
                        <lightning-input class="slds-m-bottom_small" label="Banking Info (e.g., UPI ID)" name="BankingInfo__c" value={company.BankingInfo__c} onchange={handleCompanyChange} required></lightning-input>
                        <lightning-textarea class="slds-m-bottom_small" label="Address" name="Address__c" value={company.Address__c} onchange={handleCompanyChange}></lightning-textarea>
                        <lightning-textarea class="slds-m-bottom_small" label="About Your Company" name="About__c" value={company.About__c} onchange={handleCompanyChange}></lightning-textarea>
                        
                        <div class="slds-m-top_large slds-text-align_right">
                            <lightning-button label="Submit Company Details" variant="brand" onclick={handleCompanySubmit} disabled={isLoading}></lightning-button>
                        </div>
                    </template>
                </div>
            </template>
            
            <template if:true={isLoading}>
                <div class="spinner-overlay">
                    <lightning-spinner alternative-text="Loading..." variant="brand" size="large"></lightning-spinner>
                </div>
            </template>
        </div>
    </div>
    <c-customerfooter></c-customerfooter>
</template>